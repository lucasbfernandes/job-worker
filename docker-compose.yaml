version: '3'
services:

  stubby4j:
    image: sandokandias/stubby4j-docker
    ports:
      - 8883:8883
    environment:
      STUBBY_PORT: 8883
    volumes:
      - ./assets/stubby4j/integrations.yaml:/usr/local/stubby.yml

  cli:
    build:
      context: ./cli
      dockerfile: build/Dockerfile
    depends_on:
      - stubby4j
    command: sh -c 'while sleep 3600; do :; done'

  server:
    build:
      context: ./server
      dockerfile: build/server/Dockerfile
    command: sh -c 'while sleep 3600; do :; done'
    ports:
      - 8080:8080
    environment:
      - LOGS_DIR=/app/server/logs
